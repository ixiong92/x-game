import{d as H,A as j,u as z,r as h,p,v as D,h as E,c as u,b as l,a as s,C as M,j as w,f as r,t as o,w as d,F as C,g as x,e as S,o as c,H as N,K as R,_ as P}from"./index-J8i9tB8A.js";import{G as k}from"./GameButton-BwWB8KzV.js";import{G as U}from"./GameCard-FCkXvoNR.js";import{S as W}from"./ParticleEffect.vue_vue_type_style_index_0_scoped_0f834ed3_lang-C1xJ9BwO.js";import{s as A,H as q}from"./touch-handler-DtA4rPka.js";import{P as I}from"./ParticleEffect-xsao217C.js";const K={class:"result-container"},L={class:"result-content"},J={class:"grade-display"},O={class:"grade-emoji"},X={class:"score-display"},Y={class:"score-value"},Z={class:"stats-grid"},ss={class:"stat-item"},ts={class:"stat-info"},es={class:"stat-value"},os={class:"stat-item"},as={class:"stat-info"},ns={class:"stat-value"},ls={class:"stat-item"},is={class:"stat-info"},rs={class:"stat-value"},cs={class:"stat-item"},us={class:"stat-info"},ds={class:"stat-value"},vs={class:"stat-item"},_s={class:"stat-info"},ps={class:"stat-value"},ms={class:"stat-item"},gs={class:"stat-info"},fs={class:"stat-value"},hs={key:0,class:"wrong-questions-button-section"},ws={key:1,class:"achievements-section"},ks={class:"achievements-list"},bs={class:"achievement-icon"},ys={class:"achievement-info"},Cs={class:"achievement-name"},xs={class:"achievement-desc"},Ss={class:"action-buttons"},As={class:"dialog-content"},qs={class:"question-header"},$s={class:"question-number"},Bs={class:"question-index"},Ts={class:"question-content"},Vs={class:"question-text"},Gs={class:"question-answer"},Qs={class:"answer-row"},Fs={class:"user-answer"},Hs={class:"answer-row"},js={class:"correct-answer"},zs=H({__name:"Result",setup(Ds){const m=E(),$=j(),B=z(),b=h(!1),g=h(0),f=h(!1),a=p(()=>$.gameState.result||{score:0,correctCount:0,wrongCount:0,accuracy:0,totalTime:0,maxCombo:0,averageScore:0,grade:"C",wrongQuestions:[]}),T=p(()=>a.value.wrongCount===0?"😄":"😢"),v=p(()=>{const n=a.value.wrongQuestions;if(!n||n.length===0)return[];const t=new Set,i=[];for(const _ of n){const e=`${_.index}`;t.has(e)||(t.add(e),i.push(_))}return i}),y=p(()=>B.achievements.filter(n=>n.unlocked&&n.unlockedAt>Date.now()-5e3)),V=n=>{const t=Math.floor(n/60),i=n%60;return t>0?`${t}分${i}秒`:`${i}秒`},G=()=>{A.play("select"),q.light(),m.push("/number-battle/settings")},Q=()=>{A.play("select"),q.light(),m.push("/")};return D(()=>{if(!a.value||a.value.score===0){m.push("/");return}(a.value.grade==="S"||a.value.grade==="A")&&(b.value=!0,setTimeout(()=>{g.value++},500),setTimeout(()=>{g.value++},1500))}),(n,t)=>{const i=S("el-icon"),_=S("el-dialog");return c(),u("div",K,[l(r(W)),s("div",L,[s("div",J,[s("div",O,o(T.value),1),s("div",X,[t[2]||(t[2]=s("span",{class:"score-label"},"最终得分",-1)),s("span",Y,o(a.value.score),1)])]),l(r(U),{class:"stats-card",shadow:"always"},{default:d(()=>[s("div",Z,[s("div",ss,[t[4]||(t[4]=s("span",{class:"stat-icon"},"✓",-1)),s("div",ts,[t[3]||(t[3]=s("span",{class:"stat-label"},"正确",-1)),s("span",es,o(a.value.correctCount),1)])]),s("div",os,[t[6]||(t[6]=s("span",{class:"stat-icon"},"✗",-1)),s("div",as,[t[5]||(t[5]=s("span",{class:"stat-label"},"错误",-1)),s("span",ns,o(a.value.wrongCount),1)])]),s("div",ls,[t[8]||(t[8]=s("span",{class:"stat-icon"},"📊",-1)),s("div",is,[t[7]||(t[7]=s("span",{class:"stat-label"},"正确率",-1)),s("span",rs,o(a.value.accuracy)+"%",1)])]),s("div",cs,[t[10]||(t[10]=s("span",{class:"stat-icon"},"⏱",-1)),s("div",us,[t[9]||(t[9]=s("span",{class:"stat-label"},"用时",-1)),s("span",ds,o(V(a.value.totalTime)),1)])]),s("div",vs,[t[12]||(t[12]=s("span",{class:"stat-icon"},"🔥",-1)),s("div",_s,[t[11]||(t[11]=s("span",{class:"stat-label"},"最高连击",-1)),s("span",ps,o(a.value.maxCombo)+"x",1)])]),s("div",ms,[t[14]||(t[14]=s("span",{class:"stat-icon"},"⭐",-1)),s("div",gs,[t[13]||(t[13]=s("span",{class:"stat-label"},"平均分",-1)),s("span",fs,o(a.value.averageScore),1)])])])]),_:1}),v.value.length>0?(c(),u("div",hs,[l(r(k),{type:"warning",size:"large",block:"",onClick:t[0]||(t[0]=e=>f.value=!0)},{default:d(()=>[s("span",null,"❌ 查看错误题目 ("+o(v.value.length)+")",1)]),_:1})])):w("",!0),y.value.length>0?(c(),u("div",ws,[t[15]||(t[15]=s("h3",{class:"achievements-title"},"🎉 解锁新成就",-1)),s("div",ks,[(c(!0),u(C,null,x(y.value,e=>(c(),u("div",{key:e.id,class:"achievement-item"},[s("span",bs,o(e.icon),1),s("div",ys,[s("span",Cs,o(e.name),1),s("span",xs,o(e.description),1)])]))),128))])])):w("",!0),s("div",Ss,[l(r(k),{type:"success",size:"large",block:"",onClick:G},{default:d(()=>[l(i,null,{default:d(()=>[l(r(N))]),_:1}),t[16]||(t[16]=s("span",null,"再玩一次",-1))]),_:1}),l(r(k),{type:"primary",size:"large",block:"",onClick:Q},{default:d(()=>[l(i,null,{default:d(()=>[l(r(R))]),_:1}),t[17]||(t[17]=s("span",null,"返回首页",-1))]),_:1})])]),b.value?(c(),M(r(I),{key:0,type:"star",count:20,trigger:g.value,position:{x:50,y:30}},null,8,["trigger"])):w("",!0),l(_,{modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=e=>f.value=e),title:"❌ 错误题目详情",width:"90%","close-on-click-modal":!1,class:"wrong-questions-dialog"},{default:d(()=>[s("div",As,[(c(!0),u(C,null,x(v.value,(e,F)=>(c(),u("div",{key:`${e.index}-${e.userAnswer}`,class:"wrong-question-item"},[s("div",qs,[s("span",$s,"第 "+o(e.index)+" 题",1),s("span",Bs,"("+o(F+1)+"/"+o(v.value.length)+")",1)]),s("div",Ts,[s("div",Vs,o(e.question),1),s("div",Gs,[s("div",Qs,[t[18]||(t[18]=s("span",{class:"answer-label"},"你的答案:",-1)),s("span",Fs,o(e.userAnswer===0?"超时":e.userAnswer),1)]),s("div",Hs,[t[19]||(t[19]=s("span",{class:"answer-label"},"正确答案:",-1)),s("span",js,o(e.correctAnswer),1)])])])]))),128))])]),_:1},8,["modelValue"])])}}}),Ws=P(zs,[["__scopeId","data-v-a4ffce38"]]);export{Ws as default};
