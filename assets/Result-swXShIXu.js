import{d as H,A as I,u as j,r as p,p as m,v as z,h as M,c as u,b as l,a as s,C as N,j as k,f as r,t as e,w as d,F as S,g as A,e as $,o as c,H as R,K as P,_ as U}from"./index-G4hdZss8.js";import{G as y}from"./GameButton-BKIMR8Kj.js";import{G as W}from"./GameCard-CYKbrR5m.js";import{S as K}from"./ParticleEffect.vue_vue_type_style_index_0_scoped_db33c9d5_lang-BasWhRSt.js";import{s as q,H as B}from"./touch-handler-DtA4rPka.js";import{P as L}from"./ParticleEffect-Cfq69c8Y.js";const J={class:"result-container"},O={class:"result-content"},X={class:"grade-display"},Y={class:"grade-emoji"},Z={class:"score-display"},ss={class:"score-value"},ts={class:"stats-grid"},es={class:"stat-item"},as={class:"stat-info"},os={class:"stat-value"},ns={class:"stat-item"},ls={class:"stat-info"},is={class:"stat-value"},rs={class:"stat-item"},cs={class:"stat-info"},us={class:"stat-value"},ds={class:"stat-item"},vs={class:"stat-info"},_s={class:"stat-value"},ps={class:"stat-item"},ms={class:"stat-info"},gs={class:"stat-value"},fs={class:"stat-item"},hs={class:"stat-info"},ws={class:"stat-value"},bs={key:0,class:"wrong-questions-button-section"},ks={key:1,class:"achievements-section"},ys={class:"achievements-list"},Cs={class:"achievement-icon"},xs={class:"achievement-info"},Ss={class:"achievement-name"},As={class:"achievement-desc"},$s={class:"action-buttons"},qs={class:"dialog-content"},Bs={class:"question-header"},Ts={class:"question-number"},Vs={class:"question-index"},Gs={class:"question-content"},Qs={class:"question-text"},Ds={class:"question-answer"},Es={class:"answer-row"},Fs={class:"user-answer"},Hs={class:"answer-row"},Is={class:"correct-answer"},js=H({__name:"Result",setup(zs){const w=M(),T=I(),V=j(),C=p(!1),b=p(0),g=p(!1),v=p(!1),f=p(5),a=m(()=>T.gameState.result||{score:0,correctCount:0,wrongCount:0,accuracy:0,totalTime:0,maxCombo:0,averageScore:0,grade:"C"});m(()=>({S:"完美！",A:"优秀！",B:"良好！",C:"及格！",D:"继续努力！"})[a.value.grade]||"继续努力！");const G=m(()=>a.value.wrongCount===0?"😄":"😢"),_=m(()=>{if(!a.value.wrongQuestions||a.value.wrongQuestions.length===0)return[];const o=new Set,t=[];for(const i of a.value.wrongQuestions){const h=`${i.index}`;o.has(h)||(o.add(h),t.push(i))}return t}),x=m(()=>V.achievements.filter(o=>o.unlocked&&o.unlockedAt>Date.now()-5e3)),Q=o=>{const t=Math.floor(o/60),i=o%60;return t>0?`${t}分${i}秒`:`${i}秒`},D=()=>{q.play("select"),B.light(),w.push("/number-battle/settings")},E=()=>{q.play("select"),B.light(),w.push("/")};return z(()=>{if(!a.value||a.value.score===0){w.push("/");return}(a.value.grade==="S"||a.value.grade==="A")&&(C.value=!0,setTimeout(()=>{b.value++},500),setTimeout(()=>{b.value++},1500)),_.value.length>0&&setTimeout(()=>{g.value=!0},500);let o=5;f.value=o;const t=setInterval(()=>{o--,f.value=o,o<=0&&(clearInterval(t),v.value=!0)},1e3)}),(o,t)=>{const i=$("el-icon"),h=$("el-dialog");return c(),u("div",J,[l(r(K)),s("div",O,[s("div",X,[s("div",Y,e(G.value),1),s("div",Z,[t[2]||(t[2]=s("span",{class:"score-label"},"最终得分",-1)),s("span",ss,e(a.value.score),1)])]),l(r(W),{class:"stats-card",shadow:"always"},{default:d(()=>[s("div",ts,[s("div",es,[t[4]||(t[4]=s("span",{class:"stat-icon"},"✓",-1)),s("div",as,[t[3]||(t[3]=s("span",{class:"stat-label"},"正确",-1)),s("span",os,e(a.value.correctCount),1)])]),s("div",ns,[t[6]||(t[6]=s("span",{class:"stat-icon"},"✗",-1)),s("div",ls,[t[5]||(t[5]=s("span",{class:"stat-label"},"错误",-1)),s("span",is,e(a.value.wrongCount),1)])]),s("div",rs,[t[8]||(t[8]=s("span",{class:"stat-icon"},"📊",-1)),s("div",cs,[t[7]||(t[7]=s("span",{class:"stat-label"},"正确率",-1)),s("span",us,e(a.value.accuracy)+"%",1)])]),s("div",ds,[t[10]||(t[10]=s("span",{class:"stat-icon"},"⏱",-1)),s("div",vs,[t[9]||(t[9]=s("span",{class:"stat-label"},"用时",-1)),s("span",_s,e(Q(a.value.totalTime)),1)])]),s("div",ps,[t[12]||(t[12]=s("span",{class:"stat-icon"},"🔥",-1)),s("div",ms,[t[11]||(t[11]=s("span",{class:"stat-label"},"最高连击",-1)),s("span",gs,e(a.value.maxCombo)+"x",1)])]),s("div",fs,[t[14]||(t[14]=s("span",{class:"stat-icon"},"⭐",-1)),s("div",hs,[t[13]||(t[13]=s("span",{class:"stat-label"},"平均分",-1)),s("span",ws,e(a.value.averageScore),1)])])])]),_:1}),_.value.length>0?(c(),u("div",bs,[l(r(y),{type:"warning",size:"large",block:"",onClick:t[0]||(t[0]=n=>g.value=!0)},{default:d(()=>[s("span",null,"❌ 查看错误题目 ("+e(_.value.length)+")",1)]),_:1})])):k("",!0),x.value.length>0?(c(),u("div",ks,[t[15]||(t[15]=s("h3",{class:"achievements-title"},"🎉 解锁新成就",-1)),s("div",ys,[(c(!0),u(S,null,A(x.value,n=>(c(),u("div",{key:n.id,class:"achievement-item"},[s("span",Cs,e(n.icon),1),s("div",xs,[s("span",Ss,e(n.name),1),s("span",As,e(n.description),1)])]))),128))])])):k("",!0),s("div",$s,[l(r(y),{type:"success",size:"large",block:"",disabled:!v.value,onClick:D},{default:d(()=>[l(i,null,{default:d(()=>[l(r(R))]),_:1}),s("span",null,"再玩一次"+e(v.value?"":`(${f.value}s)`),1)]),_:1},8,["disabled"]),l(r(y),{type:"primary",size:"large",block:"",disabled:!v.value,onClick:E},{default:d(()=>[l(i,null,{default:d(()=>[l(r(P))]),_:1}),s("span",null,"返回首页"+e(v.value?"":`(${f.value}s)`),1)]),_:1},8,["disabled"])])]),C.value?(c(),N(r(L),{key:0,type:"star",count:20,trigger:b.value,position:{x:50,y:30}},null,8,["trigger"])):k("",!0),l(h,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=n=>g.value=n),title:"❌ 错误题目详情",width:"90%","close-on-click-modal":!1,class:"wrong-questions-dialog"},{default:d(()=>[s("div",qs,[(c(!0),u(S,null,A(_.value,(n,F)=>(c(),u("div",{key:`${n.index}-${n.userAnswer}`,class:"wrong-question-item"},[s("div",Bs,[s("span",Ts,"第 "+e(n.index)+" 题",1),s("span",Vs,"("+e(F+1)+"/"+e(_.value.length)+")",1)]),s("div",Gs,[s("div",Qs,e(n.question),1),s("div",Ds,[s("div",Es,[t[16]||(t[16]=s("span",{class:"answer-label"},"你的答案:",-1)),s("span",Fs,e(n.userAnswer===0?"超时":n.userAnswer),1)]),s("div",Hs,[t[17]||(t[17]=s("span",{class:"answer-label"},"正确答案:",-1)),s("span",Is,e(n.correctAnswer),1)])])])]))),128))])]),_:1},8,["modelValue"])])}}}),Ks=U(js,[["__scopeId","data-v-77628c84"]]);export{Ks as default};
