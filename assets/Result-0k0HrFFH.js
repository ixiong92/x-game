import{d as F,A as H,u as j,r as h,p as v,v as z,h as E,c as u,b as l,a as s,C as M,j as w,f as r,t as e,w as d,F as C,g as x,e as S,o as c,H as N,K as R,_ as P}from"./index-CV7umQ8o.js";import{G as k}from"./GameButton-DP0dM53k.js";import{G as U}from"./GameCard-DUe-00Th.js";import{S as W}from"./ParticleEffect.vue_vue_type_style_index_0_scoped_db33c9d5_lang-D38TuCCH.js";import{s as A,H as q}from"./touch-handler-DtA4rPka.js";import{P as I}from"./ParticleEffect-BGkooad0.js";const K={class:"result-container"},L={class:"result-content"},J={class:"grade-display"},O={class:"grade-emoji"},X={class:"score-display"},Y={class:"score-value"},Z={class:"stats-grid"},ss={class:"stat-item"},ts={class:"stat-info"},es={class:"stat-value"},as={class:"stat-item"},os={class:"stat-info"},ns={class:"stat-value"},ls={class:"stat-item"},is={class:"stat-info"},rs={class:"stat-value"},cs={class:"stat-item"},us={class:"stat-info"},ds={class:"stat-value"},vs={class:"stat-item"},_s={class:"stat-info"},ps={class:"stat-value"},ms={class:"stat-item"},gs={class:"stat-info"},fs={class:"stat-value"},hs={key:0,class:"wrong-questions-button-section"},ws={key:1,class:"achievements-section"},ks={class:"achievements-list"},bs={class:"achievement-icon"},ys={class:"achievement-info"},Cs={class:"achievement-name"},xs={class:"achievement-desc"},Ss={class:"action-buttons"},As={class:"dialog-content"},qs={class:"question-header"},Bs={class:"question-number"},$s={class:"question-index"},Ts={class:"question-content"},Vs={class:"question-text"},Gs={class:"question-answer"},Qs={class:"answer-row"},Ds={class:"user-answer"},Fs={class:"answer-row"},Hs={class:"correct-answer"},js=F({__name:"Result",setup(zs){const m=E(),B=H(),$=j(),b=h(!1),g=h(0),f=h(!1),a=v(()=>B.gameState.result||{score:0,correctCount:0,wrongCount:0,accuracy:0,totalTime:0,maxCombo:0,averageScore:0,grade:"C"});v(()=>({S:"完美！",A:"优秀！",B:"良好！",C:"及格！",D:"继续努力！"})[a.value.grade]||"继续努力！");const T=v(()=>a.value.wrongCount===0?"😄":"😢"),_=v(()=>{if(!a.value.wrongQuestions||a.value.wrongQuestions.length===0)return[];const n=new Set,t=[];for(const i of a.value.wrongQuestions){const p=`${i.index}`;n.has(p)||(n.add(p),t.push(i))}return t}),y=v(()=>$.achievements.filter(n=>n.unlocked&&n.unlockedAt>Date.now()-5e3)),V=n=>{const t=Math.floor(n/60),i=n%60;return t>0?`${t}分${i}秒`:`${i}秒`},G=()=>{A.play("select"),q.light(),m.push("/number-battle/settings")},Q=()=>{A.play("select"),q.light(),m.push("/")};return z(()=>{if(!a.value||a.value.score===0){m.push("/");return}(a.value.grade==="S"||a.value.grade==="A")&&(b.value=!0,setTimeout(()=>{g.value++},500),setTimeout(()=>{g.value++},1500))}),(n,t)=>{const i=S("el-icon"),p=S("el-dialog");return c(),u("div",K,[l(r(W)),s("div",L,[s("div",J,[s("div",O,e(T.value),1),s("div",X,[t[2]||(t[2]=s("span",{class:"score-label"},"最终得分",-1)),s("span",Y,e(a.value.score),1)])]),l(r(U),{class:"stats-card",shadow:"always"},{default:d(()=>[s("div",Z,[s("div",ss,[t[4]||(t[4]=s("span",{class:"stat-icon"},"✓",-1)),s("div",ts,[t[3]||(t[3]=s("span",{class:"stat-label"},"正确",-1)),s("span",es,e(a.value.correctCount),1)])]),s("div",as,[t[6]||(t[6]=s("span",{class:"stat-icon"},"✗",-1)),s("div",os,[t[5]||(t[5]=s("span",{class:"stat-label"},"错误",-1)),s("span",ns,e(a.value.wrongCount),1)])]),s("div",ls,[t[8]||(t[8]=s("span",{class:"stat-icon"},"📊",-1)),s("div",is,[t[7]||(t[7]=s("span",{class:"stat-label"},"正确率",-1)),s("span",rs,e(a.value.accuracy)+"%",1)])]),s("div",cs,[t[10]||(t[10]=s("span",{class:"stat-icon"},"⏱",-1)),s("div",us,[t[9]||(t[9]=s("span",{class:"stat-label"},"用时",-1)),s("span",ds,e(V(a.value.totalTime)),1)])]),s("div",vs,[t[12]||(t[12]=s("span",{class:"stat-icon"},"🔥",-1)),s("div",_s,[t[11]||(t[11]=s("span",{class:"stat-label"},"最高连击",-1)),s("span",ps,e(a.value.maxCombo)+"x",1)])]),s("div",ms,[t[14]||(t[14]=s("span",{class:"stat-icon"},"⭐",-1)),s("div",gs,[t[13]||(t[13]=s("span",{class:"stat-label"},"平均分",-1)),s("span",fs,e(a.value.averageScore),1)])])])]),_:1}),_.value.length>0?(c(),u("div",hs,[l(r(k),{type:"warning",size:"large",block:"",onClick:t[0]||(t[0]=o=>f.value=!0)},{default:d(()=>[s("span",null,"❌ 查看错误题目 ("+e(_.value.length)+")",1)]),_:1})])):w("",!0),y.value.length>0?(c(),u("div",ws,[t[15]||(t[15]=s("h3",{class:"achievements-title"},"🎉 解锁新成就",-1)),s("div",ks,[(c(!0),u(C,null,x(y.value,o=>(c(),u("div",{key:o.id,class:"achievement-item"},[s("span",bs,e(o.icon),1),s("div",ys,[s("span",Cs,e(o.name),1),s("span",xs,e(o.description),1)])]))),128))])])):w("",!0),s("div",Ss,[l(r(k),{type:"success",size:"large",block:"",onClick:G},{default:d(()=>[l(i,null,{default:d(()=>[l(r(N))]),_:1}),t[16]||(t[16]=s("span",null,"再玩一次",-1))]),_:1}),l(r(k),{type:"primary",size:"large",block:"",onClick:Q},{default:d(()=>[l(i,null,{default:d(()=>[l(r(R))]),_:1}),t[17]||(t[17]=s("span",null,"返回首页",-1))]),_:1})])]),b.value?(c(),M(r(I),{key:0,type:"star",count:20,trigger:g.value,position:{x:50,y:30}},null,8,["trigger"])):w("",!0),l(p,{modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=o=>f.value=o),title:"❌ 错误题目详情",width:"90%","close-on-click-modal":!1,class:"wrong-questions-dialog"},{default:d(()=>[s("div",As,[(c(!0),u(C,null,x(_.value,(o,D)=>(c(),u("div",{key:`${o.index}-${o.userAnswer}`,class:"wrong-question-item"},[s("div",qs,[s("span",Bs,"第 "+e(o.index)+" 题",1),s("span",$s,"("+e(D+1)+"/"+e(_.value.length)+")",1)]),s("div",Ts,[s("div",Vs,e(o.question),1),s("div",Gs,[s("div",Qs,[t[18]||(t[18]=s("span",{class:"answer-label"},"你的答案:",-1)),s("span",Ds,e(o.userAnswer===0?"超时":o.userAnswer),1)]),s("div",Fs,[t[19]||(t[19]=s("span",{class:"answer-label"},"正确答案:",-1)),s("span",Hs,e(o.correctAnswer),1)])])])]))),128))])]),_:1},8,["modelValue"])])}}}),Ws=P(js,[["__scopeId","data-v-ff408425"]]);export{Ws as default};
